<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Eco Quiz</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
   <audio id="correctSound" src="{{ url_for('static', filename='correct.mp3') }}"></audio>
<audio id="wrongSound" src="{{ url_for('static', filename='wrong.mp3') }}"></audio>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#34D399",
            },
          },
        },
      };

    document.addEventListener("DOMContentLoaded", function () {
    const showResult = {{ 'true' if show_result else 'false' }};
    const isCorrect = {{ 'true' if is_correct else 'false' }};

    if (showResult) {
      if (isCorrect) {
        document.getElementById('correctSound').play();
      } else {
        document.getElementById('wrongSound').play();
      }
    }
  });
    </script>
    <style>
@keyframes fadeIn {
  0% { opacity: 0; transform: scale(0.95); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  50% { transform: translateX(5px); }
  75% { transform: translateX(-5px); }
  100% { transform: translateX(0); }
}

.animate-fade-in {
  animation: fadeIn 0.4s ease-out forwards;
}
.progress-container {
  width: 100%;
  background-color: #e0e0e0;
  border-radius: 20px;
  height: 20px;
  margin-bottom: 20px;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background-color: #4CAF50;
  transition: width 0.5s ease-in-out;
}

.animate-shake {
  animation: shake 0.4s ease;
}

</style>

  </head>
 <body class="bg-gray-900 text-white min-h-screen flex items-center justify-center">
   <div class="max-w-xl w-full">
          <div class="absolute top-0 right-0 p-4 text-sm text-gray-300">
        ‚è± Time left: <span id="timer">15</span>s
      </div>
       <div class="mb-6">
        <div class="text-sm mb-1 text-gray-300">
          Question {{ current }} of {{ total }}
        </div>
        <div class="w-full bg-gray-700 h-3 rounded-full overflow-hidden">
          <div
            class="bg-green-500 h-full transition-all duration-500 ease-out"
            style="width: {{ (current / total) * 100 }}%;"
          ></div>
        </div>
      </div>
    <div class="w-full max-w-2xl bg-gray-800 p-8 rounded-2xl shadow-xl">

      <div class="progress-container">
  <div class="progress-bar" id="progress-bar" style="width: {{ (current / total) * 100 }}%;"></div>
</div>

<div x-data="{ show: false }" x-init="setTimeout(() => show = true, 100)" x-show="show"
     x-transition:enter="transition-opacity duration-500"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition-opacity duration-300"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="w-full max-w-2xl bg-gray-800 p-8 rounded-2xl shadow-xl mt-10">

    <h2 class="text-2xl font-semibold text-primary mb-4"> Question {{ current }} of {{ total }}</h2>
    <form method="post" id="quizForm" class="space-y-6">
    <p class="text-lg font-medium mb-4">{{ question.question }}</p>
    <div class="space-y-2">
      {% for opt in question.options %}
           {% set is_selected = opt == selected %}
      {% set is_correct_opt = opt == correct %}

      <label class="flex items-center space-x-3 p-3 rounded-xl transition duration-300 ease-in-out transform
       {% if show_result %}
          {% if is_correct_opt %}
            bg-green-700 scale-105
          {% elif is_selected %}
            bg-red-700 scale-105
          {% else %}
            bg-gray-700
          {% endif %}
        {% else %}
          hover:bg-gray-700 hover:scale-105
        {% endif %}
        p-2 rounded-lg transition
        ">       
      <input
      type="radio"
      name="answer"
      value="{{ opt }}"
               {% if is_selected %}checked{% endif %}
          {% if show_result %}disabled{% endif %}
      class="form-radio h-5 w-5 text-primary bg-gray-700 border-gray-600 focus:ring-primary"/> 
                <span class="text-gray-200">{{ opt }}</span>
              </label>
      {% endfor %}
              </div>
{% if show_result %}
    <div class="mt-4 text-lg font-semibold animate-fade-in">
      {% if is_correct %}
      <div class="text-green-400 transition duration-300 ease-out scale-100">  ‚úÖ Correct! </div>
      {% else %}
              <div class="text-red-400 transition duration-300 ease-out scale-100">

        ‚ùå Wrong. Correct answer: <span class="text-primary font-bold">{{ correct }}</span>
                </div>
  <div class="mt-6 p-4 bg-gray-700 rounded-lg border border-primary animate-fade-in">
    <h3 class="text-lg font-semibold text-primary">üå± Eco Fact:</h3>
    <p class="text-gray-300 mt-2">{{ fact }}</p>
  </div>

      {% endif %}
    </div>
  {% endif %}
                    <div class="pt-4">
      {% if not show_result %}
      <button type="submit" name="answer" class="bg-primary hover:bg-emerald-500 text-white font-semibold py-2 px-6 rounded-lg transition duration-200">Submit</button>
    {% else %}
      <button type="submit" name="next" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-200">Next</button>
    {% endif %}
                    </div>
    </form>
  </div>
    {% if show_result %}

{% endif %}
  </div>

  <script src="/static/quiz.js"></script>
  </body>
</html>
